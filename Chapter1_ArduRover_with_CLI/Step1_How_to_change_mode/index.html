<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Step1 How to change mode - MAVROS Tutorial</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Step1 How to change mode";
    var mkdocs_page_input_path = "Chapter1_ArduRover_with_CLI/Step1_How_to_change_mode.md";
    var mkdocs_page_url = "/Chapter1_ArduRover_with_CLI/Step1_How_to_change_mode/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> MAVROS Tutorial</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../about/">About</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Chapter1 ArduRover with CLI</span>
    <ul class="subnav">
                <li class=" current">
                    
    <a class="current" href="./">Step1 How to change mode</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#how-to-change-mode-of-ardupilot-sitl-rover">How to change mode of Ardupilot-SITL Rover</a></li>
    

    <li class="toctree-l3"><a href="#initialize">Initialize</a></li>
    

    <li class="toctree-l3"><a href="#change-vehicle-mode">Change vehicle mode</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#change-vehicle-mode-using-mavproxy-or-ardupilot-sitl">Change vehicle mode using MAVProxy or Ardupilot-SITL</a></li>
        
            <li><a class="toctree-l4" href="#change-vehicle-mode-using-ros-rqt">Change vehicle mode using ROS rqt:</a></li>
        
            <li><a class="toctree-l4" href="#change-vehicle-mode-using-ros-command-lines">Change vehicle mode using ROS command lines</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../Step2_How_to_Arm_and_Disarm/">Step2 How to Arm and Disarm</a>
                </li>
                <li class="">
                    
    <a class="" href="../Step3_How_to_make_move/">Step3 How to make move</a>
                </li>
                <li class="">
                    
    <a class="" href="../Step4_How_to_set_and_get_parameters/">Step4 How to set and get parameters</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Chapter2 ArduRover with Python</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../Chapter2_ArduRover_with_Python/Step1_Drive_rover/">Step1 Drive rover</a>
                </li>
                <li class="">
                    
    <a class="" href="../../Chapter2_ArduRover_with_Python/Step2_Detials/">Step2 Detials</a>
                </li>
                <li class="">
                    
    <a class="" href="../../Chapter2_ArduRover_with_Python/Step3_How_to_use/">Step3 How to use</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Chapter3 ArduRover with C++</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../Chapter3_ArduRover_with_C++/Step1_Drive_rover/">Step1 Drive rover</a>
                </li>
                <li class="">
                    
    <a class="" href="../../Chapter3_ArduRover_with_C++/Step2_Details/">Step2 Details</a>
                </li>
                <li class="">
                    
    <a class="" href="../../Chapter3_ArduRover_with_C++/Step3_How_to_use/">Step3 How to use</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">MAVROS Tutorial</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Chapter1 ArduRover with CLI &raquo;</li>
        
      
    
    <li>Step1 How to change mode</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="how-to-change-mode-of-ardupilot-sitl-rover">How to change mode of Ardupilot-SITL Rover</h1>
<p><em>Author:</em> Masoud Iranmehr</p>
<p><em>Github Page:</em> <a href="https://github.com/masoudir/mavros_tutorial">github.com/masoudir/mavros_tutorial</a></p>
<h1 id="initialize">Initialize</h1>
<p>Please follow steps mentioned in this <a href="../..">link</a></p>
<h1 id="change-vehicle-mode">Change vehicle mode</h1>
<h2 id="change-vehicle-mode-using-mavproxy-or-ardupilot-sitl">Change vehicle mode using MAVProxy or Ardupilot-SITL</h2>
<h3 id="get-mode">Get mode</h3>
<p>If you want to see the last mode of vehicle, you can just looking for the name before "&gt;" character in these terminals.</p>
<h3 id="set-mode">Set mode</h3>
<p>Also if you want to change the mode, you can send your commands directly from your terminal provided by MAVProxy or SITL. For example if you want to change vehicle mode to <em>"GUIDED"</em>, you can type this command:</p>
<ul>
<li><code>GUIDED</code> - Change mode to GUIDED</li>
</ul>
<p>Also you can view all of available modes for your vehicle via this command:</p>
<ul>
<li><code>mode</code> - Shows all available modes</li>
</ul>
<h2 id="change-vehicle-mode-using-ros-rqt">Change vehicle mode using ROS rqt:</h2>
<p>At first you need to add two plugin from rqt:</p>
<pre><code>Plugins -&gt; Topics -&gt; Topic Monitor
Plugins -&gt; Services -&gt; Service Caller
</code></pre>
<p>Then in "Topic Monitor" side, you have to tick the topic of "/mavros/state" to view its contents, so that you can get 
the vehicle mode and also some other parameters such as "arm status" and "Guided status".</p>
<p>Then in "Service Caller" side, you have to select "/mavros/set_mode" and then in the field of "custom_mode", you can set
your vehicle mode. Then click on "call" button to send this message. The result should be as follow:</p>
<p><img alt="Screenshot" src="../../img/ch1_rqt_setmode.jpg" /></p>
<h2 id="change-vehicle-mode-using-ros-command-lines">Change vehicle mode using ROS command lines</h2>
<h3 id="get-mode_1">Get mode</h3>
<p>If you want to see the last mode of the vehicle, you can just type this command:</p>
<ul>
<li><code>rostopic echo /mavros/state</code> - Returns all contents of /mavros/state topic periodically</li>
</ul>
<p>The results should be as similar as this:</p>
<pre><code>---                                                                                                                                                                    
header:                                                                                                                                                                
  stamp: 09                                                                                                                                                            
    secs: 1595198641

    nsecs: 651358095                                                                                                                                                   
  frame_id: ''                                                                                                                                                         
connected: True                                                                                                                                                        
guided: False                                                                                                                                                          
manual_input: True

mode: "MANUAL"                                                                                                                                                         
system_status: 4                                                                                                                                                       
---
</code></pre>
<p>You can find the mode in the field of "mode" of the result shown.</p>
<h3 id="set-mode_1">Set mode</h3>
<p>You need to call a ros service in order to do that. Just follow these commands:</p>
<ul>
<li><code>rosservice info /mavros/set_mode</code> - To see its arguments and type of its Class Message</li>
</ul>
<p>This command gives you this result:</p>
<pre><code>Node: /mavros
URI: rosrpc://ubuntu:42571
Type: mavros_msgs/SetMode
Args: base_mode custom_mode
</code></pre>
<p>"mavros_msgs/SetMode" is the type of this service srv file and "Args" are our input arguments, but we have to know their types, so that we type this command:</p>
<ul>
<li><code>rossrv show mavros_msgs/SetMode</code> - Getting details of the mentioned srv file</li>
</ul>
<p>This will result as below:</p>
<pre><code>uint8 MAV_MODE_PREFLIGHT=0
uint8 MAV_MODE_STABILIZE_DISARMED=80
uint8 MAV_MODE_STABILIZE_ARMED=208
uint8 MAV_MODE_MANUAL_DISARMED=64
uint8 MAV_MODE_MANUAL_ARMED=192
uint8 MAV_MODE_GUIDED_DISARMED=88
uint8 MAV_MODE_GUIDED_ARMED=216
uint8 MAV_MODE_AUTO_DISARMED=92
uint8 MAV_MODE_AUTO_ARMED=220
uint8 MAV_MODE_TEST_DISARMED=66
uint8 MAV_MODE_TEST_ARMED=194
uint8 base_mode
string custom_mode
---
bool mode_sent
</code></pre>
<p>In this case, "custom_mode" is the parameter needs to being configured and its type is "string". For example if you want to change the vehicle 
mode to "GUIDED" follow this command:</p>
<ul>
<li><code>rosservice call /mavros/set_mode "custom_mode: 'GUIDED'"</code> - Change vehicle mode to "GUIDED"</li>
</ul>
<p>Another method is to use "rosrun" command:</p>
<ul>
<li>
<p><code>rosrun mavros mavsys mode -c MANUAL</code> - If you want to change mode to "MANUAL"</p>
</li>
<li>
<p><code>rosrun mavros mavsys mode -b &lt;ENUM VALUE&gt;</code> - If you want to use "base_mode" to change mode</p>
</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Step2_How_to_Arm_and_Disarm/" class="btn btn-neutral float-right" title="Step2 How to Arm and Disarm">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../about/" class="btn btn-neutral" title="About"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../about/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Step2_How_to_Arm_and_Disarm/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../js/theme.js"></script>

</body>
</html>
